<!DOCTYPE html>
<html lang="es">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0, maximum-scale=1.0, user-scalable=no">
    <title>Busca...</title>
    
    <link href="https://fonts.googleapis.com/css2?family=Poppins:wght@300&display=swap" rel="stylesheet">

    <meta property="og:title" content="Tengo un peque帽o detalle para ti..." />
    <meta property="og:description" content="Busca en la oscuridad. Hay algo esperando por ti. " />
    <meta property="og:image" content="preview.png" />
    <meta property="og:url" content="https://tu-usuario.github.io/tu-proyecto" />
    <meta property="og:type" content="website" />
    <meta name="theme-color" content="#000000">

    <style>
        body {
            margin: 0;
            padding: 0;
            background-color: #000; /* Fondo base negro */
            height: 100vh;
            overflow: hidden;
            font-family: 'Poppins', sans-serif;
            cursor: none; 
            touch-action: none;
        }

        /* Contenedor del juego */
        #game-area {
            position: relative;
            width: 100%;
            height: 100%;
            z-index: 1;
        }

        /* El regalo  */
        #gift {
            position: absolute;
            font-size: 4rem;
            cursor: pointer;
            filter: drop-shadow(0 0 10px rgba(255, 215, 0, 0.5));
            user-select: none;
            -webkit-tap-highlight-color: transparent;
            z-index: 2;
            transition: transform 0.1s;
        }

        /* La capa de oscuridad (La linterna) */
        #flashlight-layer {
            position: fixed;
            top: 0;
            left: 0;
            width: 100%;
            height: 100%;
            pointer-events: none;
            z-index: 3;
            background: radial-gradient(
                circle 120px at var(--x, 50%) var(--y, 50%), 
                transparent 0%, 
                rgba(0, 0, 0, 0.95) 20%, 
                rgba(0, 0, 0, 1) 40%
            );
            transition: opacity 0.5s ease; /* Para desvanecerse suavemente al final */
        }

        /* Contenedor para las part铆culas (POR ENCIMA de la oscuridad) */
        #particles-container {
            position: fixed;
            top: 0;
            left: 0;
            width: 100%;
            height: 100%;
            pointer-events: none;
            z-index: 20; /* Muy arriba para que se vea claro */
            overflow: hidden;
        }

        .particle {
            position: absolute;
            border-radius: 50%;
            pointer-events: none;
        }

        /* Texto de instrucci贸n */
        #hint {
            position: absolute;
            bottom: 30px;
            width: 100%;
            text-align: center;
            color: rgba(255, 255, 255, 0.3);
            font-size: 0.9rem;
            pointer-events: none;
            z-index: 4;
            opacity: 0;
            animation: fadeIn 3s forwards 1s;
        }

        /* Transici贸n a blanco */
        #white-flash {
            position: fixed;
            top: 0;
            left: 0;
            width: 100%;
            height: 100%;
            background: white;
            z-index: 30; /* Lo m谩s alto */
            opacity: 0;
            pointer-events: none;
            transition: opacity 1.5s ease;
        }

        /* --- ANIMACIONES CSS --- */
        .shake {
            animation: shake 0.5s cubic-bezier(.36,.07,.19,.97) both;
        }

        @keyframes shake {
            10%, 90% { transform: translate3d(-1px, 0, 0) rotate(-2deg); }
            20%, 80% { transform: translate3d(2px, 0, 0) rotate(2deg); }
            30%, 50%, 70% { transform: translate3d(-4px, 0, 0) rotate(-4deg); }
            40%, 60% { transform: translate3d(4px, 0, 0) rotate(4deg); }
        }

        @keyframes fadeIn { to { opacity: 1; } }

    </style>
</head>
<body>

    <div id="white-flash"></div>
    <div id="particles-container"></div>
    <div id="flashlight-layer"></div>
    <div id="hint">Busca en la oscuridad...</div>

    <div id="game-area">
        <div id="gift"></div>
    </div>

    <script>
        const gift = document.getElementById('gift');
        const flashlight = document.getElementById('flashlight-layer');
        const whiteFlash = document.getElementById('white-flash');
        const particlesContainer = document.getElementById('particles-container');
        
        // 1. Posici贸n Aleatoria
        function randomizeGiftPosition() {
            const margin = 15;
            const randomX = Math.floor(Math.random() * (100 - (margin * 2))) + margin;
            const randomY = Math.floor(Math.random() * (100 - (margin * 2))) + margin;
            gift.style.left = randomX + '%';
            gift.style.top = randomY + '%';
        }
        randomizeGiftPosition();

        // 2. Linterna
        function updateFlashlight(x, y) {
            flashlight.style.setProperty('--x', x + 'px');
            flashlight.style.setProperty('--y', y + 'px');
        }

        document.addEventListener('mousemove', (e) => updateFlashlight(e.clientX, e.clientY));
        document.addEventListener('touchmove', (e) => {
            const touch = e.touches[0];
            updateFlashlight(touch.clientX, touch.clientY);
        }, { passive: false });
        document.addEventListener('touchstart', (e) => {
            const touch = e.touches[0];
            updateFlashlight(touch.clientX, touch.clientY);
        }, { passive: false });

        // 3. Sistema de Part铆culas
        function createExplosion(x, y) {
            const particleCount = 80; // N煤mero de part铆culas
            const colors = ['#FFD700', '#FF4500', '#FF6347', '#FFFF00']; // Amarillos y Rojos

            for (let i = 0; i < particleCount; i++) {
                const particle = document.createElement('div');
                particle.classList.add('particle');
                
                // Color aleatorio
                const color = colors[Math.floor(Math.random() * colors.length)];
                particle.style.backgroundColor = color;
                
                // Tama帽o aleatorio
                const size = Math.random() * 8 + 4; // Entre 4px y 12px
                particle.style.width = size + 'px';
                particle.style.height = size + 'px';
                
                // Posici贸n inicial (centro del regalo)
                particle.style.left = x + 'px';
                particle.style.top = y + 'px';
                
                particlesContainer.appendChild(particle);

                // F铆sica simple de explosi贸n
                const angle = Math.random() * Math.PI * 2;
                const velocity = Math.random() * 200 + 50; // Velocidad de dispersi贸n
                const tx = Math.cos(angle) * velocity;
                const ty = Math.sin(angle) * velocity;

                // Animaci贸n con WAAPI (Web Animations API) para mejor rendimiento
                const animation = particle.animate([
                    { transform: 'translate(0, 0) scale(1)', opacity: 1 },
                    { transform: `translate(${tx}px, ${ty}px) scale(0)`, opacity: 0 }
                ], {
                    duration: Math.random() * 1000 + 1000, // 1 a 2 segundos
                    easing: 'cubic-bezier(0, .9, .57, 1)',
                    fill: 'forwards'
                });

                // Limpiar DOM al terminar
                animation.onfinish = () => particle.remove();
            }
        }

        // 4. L贸gica del Juego
        let clicks = 0;

        gift.addEventListener('click', (e) => {
            clicks++;
            if (navigator.vibrate) navigator.vibrate(50);

            if (clicks === 1) {
                gift.classList.add('shake');
                setTimeout(() => gift.classList.remove('shake'), 500);
            } else {
                finishGame(e);
            }
        });

        function finishGame(e) {
            // Obtener coordenadas exactas del regalo para centrar la explosi贸n
            const rect = gift.getBoundingClientRect();
            const centerX = rect.left + rect.width / 2;
            const centerY = rect.top + rect.height / 2;

            // 1. Ocultar el regalo y la oscuridad inmediatamente
            gift.style.opacity = '0'; 
            flashlight.style.opacity = '0'; // 隆Adi贸s oscuridad!

            // 2. BOOM: Explosi贸n de part铆culas
            if (navigator.vibrate) navigator.vibrate([100, 50, 100]); // Vibraci贸n m谩s fuerte
            createExplosion(centerX, centerY);

            // 3. Transici贸n final y Redirecci贸n
            setTimeout(() => {
                whiteFlash.style.opacity = '1'; // Pantalla blanca
            }, 2000); // Esperamos 2 segundos viendo las part铆culas

            setTimeout(() => {
                window.location.href = 'razones.html';
            }, 3200); // Redirecci贸n final
        }

    </script>
</body>
</html>